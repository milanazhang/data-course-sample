# Rule based project
##專案目的
建立推薦系統，將商品推薦給Amazon電商的消費者，針對不同的消費者推薦其可能會喜歡的商品

##執行思路
**step1. 篩選商品候選人**
使用metadata資料集also_buy與also_view欄位，創造每個商品的可能推薦列表(商品->商品list)
再透過ratings資料集裡找出每個reviewer買過的高評價商品， 將這些高評價商品對應到上述列表，產出每個消費者對應到的可能購買商品列表(消費者->商品list)。

**step2. 排序**
使用ratings資料集為每個商品創造商品特徵( 總聲量、正面評價比例、購買間隔時間、銷售排名、回購率 、商品子集)
依據step1為每個消費者找出的商品列表中的商品進行排序，排序方式採用正面評價比例->總聲量->銷售排名的先後順序，創造每個商品的推薦排名。

**step3. 過濾**
將此消費者以前買過且沒有回購紀錄的商品排除

##執行方法(detail)
###資料清理

檢查資料內是否有空值、重複值，將空值過多的欄位捨棄，將重複值刪除
*選取需要用到的欄位
選擇的欄位有:
"asin","also_buy","also_view","rank","similar_item","price","brand" 
<br></br>
捨棄的欄位//原因:
" category "//全是空值
"tech1"//空值過多
"tech2"//全是空值
" fit "//全是空值
" feature "//空值過多
" date "//空值過多
" main_cat "//每個商品都一樣
" description "// 需做額外文字處理
" title "// 需做額外文字處理
"details"// 每個商品的資訊量不一 ，需做額外文字處理
" imageURL "//需做圖像處理
" imageURLHighRes "// " imageURL "//需做圖像處理 

*新增需要用到的欄位
(總聲量、正面評價比例、購買間隔時間、銷售排名、回購率 、商品子集、相似商品)
*資料型態轉換
根據dataframe裡個各個value，將型態轉換成int,float,str或np.NaN

###資料切分
將資料切分為訓練集與測試集
訓練集：2018-08-31以前的評論資料
測試集：2018-09-01以後一個月的評論資料
創造商品特徵

*計算商品總聲量與正面聲量  (modified)
使用ratings資料依據不同商品(asin)計算個別的總聲量、正面聲量
正面聲量使用評分4以上的資料做計算
計算商品回購間隔時間
**背後假設：消費者只要購買就會評論** (這個假設漏洞很多，但沒有完整的訂單資料，所以想知道每個商品有沒有可能被回購，也只能從這個資訊開始著手XD)
使用ratings資料，將每一個[asin+reviewerID]的組合透過時間進行排序，每一個entry與前一個entry進行時間相減，即可得出這個reviewerID大概隔幾天購買會購買這個asin

*計算每個商品的回購人數與總購買人數
這個主要使想知道回購率，背後假設與前一點相同，計算方式採用：
對此商品在不同時間點留過兩次評論以上的人數/ 對此商品留過評論的人數 

*計算商品推薦排名
將每個商品依據排序規則(正面聲量比例->總聲量->銷售排名)排序，為每個商品做出推薦排名

*製作推薦商品列表
根據上一點製作出來的推薦排名，將also_buy, also_view,similar_item以及屬於同個brand的商品進行排序，分別存入欄位
also_buy_sort, also_view_sort,similar_item_sort,same_brand_item_sort

###產生推薦
推薦過程為：
*針對每個消費者
*找出此消費者評價高(4-5分)的商品
*將商品從評分分數高到低進行排序
*每個商品都去驗證是否有可能回購
回購條件：有回購率，且購買間隔時間中位數大於此消費者上次購買至今的時間
如有可能回購則直接納入推薦商品列表
*依每個商品的已做好推薦列表依序推薦
*將每個商品的這四個欄位 also_buy_sort, also_view_sort,similar_item_sort,same_brand_item_sort裡面的商品列表，依序塞入推薦商品列表
*若推薦列表仍不夠K個，則將相似產品透過排序(正面評價比例->總聲量->銷售排名)選出沒買過的補足
*若推薦列表仍不夠K個，則將屬於同品牌的產品透過排序(正面評價比例->總聲量->銷售排名)選出沒買過的補足
*若推薦列表仍不夠K個，則將屬於同子集的產品透過排序(正面評價比例->總聲量->銷售排名)選出沒買過的補足
*若推薦列表仍不夠K個，則直接推薦子類別為美妝且銷售排名最好的產品 (modified) 

###結果評估
因為第一次做出來的結果不太理想，所以針對上面黑斜體(modified)的部分進行修改
*第一次(未修改前)
*第二次：將推薦最後程序使用總聲量進行排序，取代原本以銷售排名進行排序的商品
*第三次：延續第二次結果，將總聲量改用近一年的資料做計算，而非原先使用全部資料

##專案結果
上述使用的三種方法，推薦分數分別為：
*方法一:  0.00678
*方法二:  0.08475
*方法三:  0.1
